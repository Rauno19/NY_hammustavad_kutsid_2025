import pandas as pd
import argparse 

# Read in data from Excel (requires openpyxl). Adjust the filename as needed:
df = pd.read_csv('data/NY_kutsid_puhastatud_v4.csv', decimal=',')

# Rename date-related columns (optional, but helpful for clarity).
df = df.rename(columns={'DateOfBite': 'Date'})

# Merge date information into a single DateTime column, and drop the originals.
#df['DateTime'] = pd.to_datetime(
    #df['year'].astype(str) + '-' + df['month'].astype(str) + '-' + df['day'].astype(str) + ' ' + df['time'].astype(str),
    #format='%Y-%m-%d %H:%M:%S', 
  #  utc=True
#)
#df = df.drop(columns=['year', 'month', 'day', 'time'])

# Export to Parquet
df.to_parquet('data/NY_kutsid_puhastatud_v4.1.parquet', index=False)